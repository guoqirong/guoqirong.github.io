(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{hEID:function(t,a,s){"use strict";s.r(a);var e={data:function(){return{loadData:!1,token:"",userData:"",message:{}}},mounted:function(){var t=this;this.$nextTick((function(){t.token=localStorage.getItem("token")||"",t.userData=JSON.parse(localStorage.getItem("userData")),t.getData()}))},methods:{getData:function(){var t=this;this.token&&(this.loadData=!0,this.$httpRequest({url:this.$httpRequest.adornUrl("/api/v1/messages"),method:"get",params:{accesstoken:this.token,mdrender:!0}}).then((function(a){var s=a.data;t.loadData=!1,s.data.has_read_messages.forEach((function(a){a.reply.content=t.imgpContent(a.reply.content)})),s.data.hasnot_read_messages.forEach((function(a){a.reply.content=t.imgpContent(a.reply.content)})),t.message=s.data})).catch((function(a){t.$message.error("请求失败"),console.error(a)})))},imgpContent:function(t){var a=t,s=a.match(/<img.*?(?:>|\/>)/gi);if(s&&s.length>0)for(var e=0;e<s.length;e++){var r=s[e].split(" "),i="";for(var n in r)i=0==n?r[n]+' style="width: 100%"':i+" "+r[n];a=a.replace(s[e],i)}var o=a.match(/<p.*?(?:>)/gi);if(o&&o.length>0)for(var l=0;l<o.length;l++){var c=o[l].split(""),d="";for(var v in c)1==v?d=d+c[v]+' style="word-wrap: break-word;word-break: break-all;"':d+=c[v];a=a.replace(o[l],d)}return a},readAll:function(){var t=this;this.$httpRequest({url:this.$httpRequest.adornUrl("/api/v1/message/mark_all"),method:"post",params:{accesstoken:this.token}}).then((function(t){t.data,location.reload()})).catch((function(a){t.$message.error("请求失败"),console.error(a)}))},readOne:function(t){var a=this;this.$httpRequest({url:this.$httpRequest.adornUrl("/api/v1/message/mark_one/"+t),method:"post",params:{accesstoken:this.token}}).then((function(t){t.data,location.reload()})).catch((function(t){a.$message.error("请求失败"),console.error(t)}))},gotoLogin:function(){this.$router.push({path:"/login"})}}},r=s("JFUb"),i=Object(r.a)(e,(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"my-message"},[s("div",{staticClass:"lift-content"},[s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loadData,expression:"loadData"}],staticClass:"box-card"},[s("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("未读信息")]),t._v(" "),s("el-button",{staticClass:"all-read",on:{click:t.readAll}},[t._v("全部已读")])],1),t._v(" "),s("div",[t.message.hasnot_read_messages&&t.message.hasnot_read_messages.length>0?s("span",t._l(t.message.hasnot_read_messages,(function(a,e){return s("div",{key:e,staticClass:"notread-item"},[s("div",{staticClass:"user-img"},[s("el-avatar",{key:a.author.avatar_url,attrs:{shape:"square",size:40,src:a.author.avatar_url,alt:a.author.loginname}})],1),t._v(" "),s("div",{staticClass:"read-messages-title"},[s("div",{staticClass:"title"},[t._v(t._s(a.author.loginname+"回复了您的话题"))]),t._v(" "),s("div",{staticClass:"desc"},[t._v(t._s(t.$formatDate(a.create_at,"yyyy-MM-dd")))])]),t._v(" "),s("div",{staticClass:"read-btn"},[s("el-button",{on:{click:function(s){return t.readOne(a.id)}}},[t._v("已读")])],1),t._v(" "),s("div",{staticClass:"reply-content",domProps:{innerHTML:t._s(a.reply.content)}}),t._v(" "),s("div",{staticClass:"topic-title"},[t._v("话题："+t._s(a.topic.title))])])})),0):s("div",{staticClass:"is-notdata"},[t._v("暂无数据")])])]),t._v(" "),s("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.loadData,expression:"loadData"}],staticClass:"box-card"},[s("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("已读信息")])]),t._v(" "),s("div",[t.message.has_read_messages&&t.message.has_read_messages.length>0?s("span",t._l(t.message.has_read_messages,(function(a,e){return s("div",{key:e,staticClass:"read-item"},[s("div",{staticClass:"user-img"},[s("el-avatar",{key:a.author.avatar_url,attrs:{shape:"square",size:40,src:a.author.avatar_url,alt:a.author.loginname}})],1),t._v(" "),s("div",{staticClass:"read-messages-title"},[s("div",{staticClass:"title"},[t._v(t._s(a.author.loginname+"回复了您的话题"))]),t._v(" "),s("div",{staticClass:"desc"},[t._v(t._s(t.$formatDate(a.create_at,"yyyy-MM-dd")))])]),t._v(" "),s("div",{staticClass:"reply-content",domProps:{innerHTML:t._s(a.reply.content)}}),t._v(" "),s("div",{staticClass:"topic-title"},[t._v("话题："+t._s(a.topic.title))])])})),0):s("div",{staticClass:"is-notdata"},[t._v("暂无数据")])])])],1),t._v(" "),s("div",{staticClass:"right-content"},[t.userData?t._e():s("el-card",{staticClass:"box-card"},[s("span",{staticClass:"not-login"},[s("div",{staticClass:"title"},[t._v("\n          CNode：Node.js专业中文社区 \n        ")]),t._v(" "),s("div",{staticClass:"describe"},[s("span",{staticClass:"not-bottom"},[t._v("当前为游客状态，您可以")]),t._v(" "),s("el-link",{attrs:{underline:!1},on:{click:t.gotoLogin}},[t._v("登录")])],1)])]),t._v(" "),t.userData?s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("个人信息")])]),t._v(" "),s("div",{staticClass:"user"},[s("div",{staticClass:"user-img"},[s("el-avatar",{key:t.userData.avatar_url||"",attrs:{shape:"square",size:40,src:t.userData.avatar_url||"",alt:t.userData.loginname||""}})],1),t._v(" "),s("div",{staticClass:"user-name"},[t._v(t._s(t.userData.loginname||""))])])]):t._e(),t._v(" "),s("el-card",{staticClass:"box-card"},[s("div",{staticClass:"card-title",attrs:{slot:"header"},slot:"header"},[s("span",[t._v("客户端二维码")])]),t._v(" "),s("el-image",{staticStyle:{width:"248px",height:"248px"},attrs:{src:"https://static.cnodejs.org/FtG0YVgQ6iginiLpf9W4_ShjiLfU",fit:"fit"}}),t._v(" "),s("div",{staticClass:"client-box"},[s("el-link",{attrs:{underline:!1,href:"https://github.com/soliury/noder-react-native",target:"_blank"}},[t._v("客户端源码地址")])],1)],1)],1)])}),[],!1,(function(t){s("iyQy")}),null,null);a.default=i.exports},iyQy:function(t,a,s){}}]);
//# sourceMappingURL=7.f826ada5bce181d6c4f9.js.map