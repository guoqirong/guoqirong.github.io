import{p as v,q as x,e as y,r as S,i as V,d as D}from"./element-plus-978032fc.js";import{u as R,r as q}from"./index-e80b1955.js";import{b as I}from"./vue-router-9467f4ca.js";import{u as N}from"./vuex-a79d8c7c.js";import{d as U,r as A,_ as m,o as w,c as T,U as o,S as t,a as d,u as n,a2 as _}from"./@vue-a3b8ecb2.js";import"./@vueuse-972b0b46.js";import"./@element-plus-ed130b8d.js";import"./@ctrl-eb0b847c.js";import"./lodash-es-8dd21e31.js";import"./async-validator-1193b133.js";import"./@popperjs-892fd7f5.js";import"./axios-eec2155c.js";import"./mitt-dab1f1cb.js";const H={class:"login-body"},L=d("span",{class:"login-slogan"},"\u6B22\u8FCE\u6765\u5230 CNode \u4E2D\u6587\u793E\u533A",-1),M=d("span",{class:"login-title"},"token \u767B\u5F55",-1),P=_("\u767B\u5F55"),j=_("\u53D6\u6D88"),se=U({setup(z){const{isLoading:r,adornUrl:p,httpRequest:f}=R(),{commit:l}=N(),g=I(),a=A(),s=m({token:""}),k=m({token:[{required:!0,message:"\u8BF7\u8F93\u5165token\u6821\u9A8C",trigger:"blur"}]}),h=()=>{!a.value||a.value.validate(u=>{if(u)f({url:p("/api/v1/accesstoken"),method:"post",data:{accesstoken:s.token}}).then(({data:e})=>{localStorage.setItem("loginname",e.loginname),localStorage.setItem("token",s.token),l("user/updateToken",s.token),l("user/updateSimpleUserData",e),q("/")}).catch(e=>{D.error("\u767B\u5F55\u5931\u8D25"),console.error(e)});else return!1})},F=()=>{g.go(-1)};return(u,e)=>{const b=v,c=x,i=y,B=S,C=V;return w(),T("div",H,[L,o(C,{class:"box-card"},{header:t(()=>[M]),default:t(()=>[o(B,{class:"login-form",model:n(s),rules:n(k),ref_key:"ruleFormRef",ref:a,"label-width":"0px"},{default:t(()=>[o(c,{prop:"token"},{default:t(()=>[o(b,{modelValue:n(s).token,"onUpdate:modelValue":e[0]||(e[0]=E=>n(s).token=E),placeholder:"accesstoken \u767B\u5F55\u6821\u9A8C",clearable:""},null,8,["modelValue"])]),_:1}),o(c,null,{default:t(()=>[o(i,{class:"login-btn",type:"primary",onClick:h,loading:n(r)},{default:t(()=>[P]),_:1},8,["loading"]),o(i,{class:"cencel-btn",onClick:F,loading:n(r)},{default:t(()=>[j]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}});export{se as default};
