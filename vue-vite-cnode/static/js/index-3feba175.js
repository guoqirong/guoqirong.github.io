import{_ as T,U,C as $}from"./index-de5dcdad.js";import{f as V,s as L,k as S,p as N,q as P,t as x,d as R,u as z,r as H,e as y}from"./element-plus-087faedc.js";import{E as I}from"./@tinymce-d9c43e5a.js";import{_ as j,u as C,t as M,r as E,c as A}from"./index-6ed5d7bd.js";import{u as O}from"./vue-router-9467f4ca.js";import{u as Y}from"./vuex-a79d8c7c.js";import{d as G,y as Q,_ as D,r as W,c as w,U as o,S as s,Z as v,o as B,a as Z,P as J,a7 as K,a2 as X,R as ee}from"./@vue-a3b8ecb2.js";import"./@vueuse-972b0b46.js";import"./@element-plus-2403d92f.js";import"./@ctrl-eb0b847c.js";import"./lodash-es-8dd21e31.js";import"./async-validator-1193b133.js";import"./@popperjs-892fd7f5.js";import"./axios-eec2155c.js";import"./vite-plugin-qiankun-075a3e44.js";import"./mitt-dab1f1cb.js";const te=G({components:{ElCard:V,ElPageHeader:L,ElSkeleton:S,ElForm:N,ElFormItem:P,ElSelect:x,ElButton:R,Editor:I,PageWrapper:T,UserInfoComp:U,ClientQrCodeComp:$},setup(){const{state:e}=Y(),n=Q(()=>e.user.token),a=O(),i=D({id:void 0,title:"",tab:"",content:""}),p=()=>{a.name==="addTopic"?E({name:"index",params:{listParm:String(a.query.listParm)}}):a.query.userName?E({path:"/detail",query:{id:a.params.id,userName:a.query.userName}}):E({path:"/detail",query:{id:a.params.id,listParm:a.query.listParm}})},{isLoading:q,adornUrl:u,httpRequest:c}=C(),m=()=>{c({url:u(`/api/v1/topic/${a.params.id}`),method:"get",params:{mdrender:!0,accesstoken:e.user.token||""}}).then(({data:t})=>{t.data.content=A(t.data.content),Object.assign(i,t.data)}).catch(t=>{y.error("\u8BF7\u6C42\u5931\u8D25"),console.error(t)})};a.params.id&&m();const l=W(),d=D({title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898",trigger:"blur"}],tab:[{required:!0,message:"\u8BF7\u9009\u62E9\u7248\u5757",trigger:"change"}],content:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:"blur"}]}),_={height:500,width:"100%",language_url:"/vue-vite-cnode/./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"\u5FAE\u8F6F\u96C5\u9ED1=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;\u82F9\u679C\u82F9\u65B9=PingFang SC,Microsoft YaHei,sans-serif;\u5B8B\u4F53=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},f=async t=>{!t||await t.validate((k,F)=>{k?h():console.log("error submit!",F)})},{isLoading:g,httpRequest:b}=C(),h=()=>{b({url:u(`/api/v1/topics${a.name==="addTopic"?"":"/update"}`),method:"post",data:{topic_id:i.id,title:i.title,content:i.content,tab:"dev",accesstoken:n.value}}).then(({data:t})=>{t?.success&&(y.success(a.name==="addTopic"?"\u53D1\u5E03\u6210\u529F":"\u4FEE\u6539\u6210\u529F"),p())}).catch(t=>{y.error(a.name==="addTopic"?"\u53D1\u5E03\u5931\u8D25":"\u4FEE\u6539\u5931\u8D25"),console.error(t)})};return{goBack:p,route:a,isLoading:q,form:l,topicForm:i,rules:d,init:_,topicTypeList:M.filter(t=>!["all","good"].includes(t.key)),onSubmit:f,IsSubmitLoading:g}}}),oe={class:"edit-topic-body"},ae={class:"edit-topic"},se=X("\u63D0\u4EA4");function ne(e,n,a,i,p,q){const u=L,c=z,m=x,l=P,d=H,_=v("editor"),f=R,g=N,b=S,h=V,t=v("user-info-comp"),k=v("client-qr-code-comp"),F=T;return B(),w("div",oe,[o(F,null,{right:s(()=>[o(t,{isTopicsRepliesList:!1}),o(k)]),default:s(()=>[o(h,{class:"box-card"},{header:s(()=>[o(u,{class:"card-title",onBack:e.goBack,content:e.route?.name==="addTopic"?"\u53D1\u5E03\u8BDD\u9898":"\u7F16\u8F91\u8BDD\u9898"},null,8,["onBack","content"])]),default:s(()=>[Z("span",ae,[o(b,{class:"edit-skeleton",loading:e.isLoading,animated:"",rows:20},{default:s(()=>[o(g,{ref:"form",class:"edit-form",model:e.topicForm,rules:e.rules,"label-width":"auto","label-position":"top"},{default:s(()=>[o(l,{label:"\u7248\u5757",prop:"tab"},{default:s(()=>[o(m,{modelValue:e.topicForm.tab,"onUpdate:modelValue":n[0]||(n[0]=r=>e.topicForm.tab=r),placeholder:""},{default:s(()=>[(B(!0),w(J,null,K(e.topicTypeList,r=>(B(),ee(c,{key:r.key,label:r.name,value:r.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(l,{label:"\u6807\u9898",prop:"title"},{default:s(()=>[o(d,{modelValue:e.topicForm.title,"onUpdate:modelValue":n[1]||(n[1]=r=>e.topicForm.title=r)},null,8,["modelValue"])]),_:1}),o(l,{label:"\u5185\u5BB9",prop:"content"},{default:s(()=>[o(_,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:e.topicForm.content,"onUpdate:modelValue":n[2]||(n[2]=r=>e.topicForm.content=r)},null,8,["init","modelValue"])]),_:1}),o(l,{class:"is-last"},{default:s(()=>[o(f,{type:"primary",loading:e.IsSubmitLoading,onClick:n[3]||(n[3]=r=>e.onSubmit(e.form))},{default:s(()=>[se]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["loading"])])]),_:1})]),_:1})])}var Ee=j(te,[["render",ne]]);export{Ee as default};
