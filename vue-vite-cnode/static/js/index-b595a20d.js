import{s as z,t as H,u as $,q as U,p as j,e as I,r as M,m as A,i as O,d as c}from"./element-plus-978032fc.js";import{_ as Y,a as G,b as J}from"./index-5ba76d30.js";import{E as K}from"./@tinymce-d9c43e5a.js";import{u as b,c as Q,t as W,r as m}from"./index-e80b1955.js";import{u as X}from"./vue-router-9467f4ca.js";import{u as Z}from"./vuex-a79d8c7c.js";import{d as ee,y as te,_ as h,r as ae,o as d,c as k,U as t,S as n,u as o,a as se,P as oe,a7 as ne,a2 as re,R as le}from"./@vue-a3b8ecb2.js";import"./@vueuse-972b0b46.js";import"./@element-plus-ed130b8d.js";import"./@ctrl-eb0b847c.js";import"./lodash-es-8dd21e31.js";import"./async-validator-1193b133.js";import"./@popperjs-892fd7f5.js";import"./axios-eec2155c.js";import"./mitt-dab1f1cb.js";const ie={class:"edit-topic-body"},ue={class:"edit-topic"},ce=re("\u63D0\u4EA4"),De=ee({setup(me){const{state:p}=Z(),y=te(()=>p.user.token),a=X(),r=h({id:void 0,title:"",tab:"",content:""}),_=()=>{a.name==="addTopic"?m({name:"index",params:{listParm:String(a.query.listParm)}}):a.query.userName?m({path:"/detail",query:{id:a.params.id,userName:a.query.userName}}):m({path:"/detail",query:{id:a.params.id,listParm:a.query.listParm}})},{isLoading:E,adornUrl:f,httpRequest:F}=b(),x=()=>{F({url:f(`/api/v1/topic/${a.params.id}`),method:"get",params:{mdrender:!0,accesstoken:p.user.token||""}}).then(({data:e})=>{e.data.content=Q(e.data.content),Object.assign(r,e.data)}).catch(e=>{c.error("\u8BF7\u6C42\u5931\u8D25"),console.error(e)})};a.params.id&&x();const g=ae(),v=h({title:[{required:!0,message:"\u8BF7\u8F93\u5165\u6807\u9898",trigger:"blur"}],tab:[{required:!0,message:"\u8BF7\u9009\u62E9\u7248\u5757",trigger:"change"}],content:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9",trigger:"blur"}]}),B={height:500,width:"100%",language_url:"/vue-vite-cnode/./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"\u5FAE\u8F6F\u96C5\u9ED1=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;\u82F9\u679C\u82F9\u65B9=PingFang SC,Microsoft YaHei,sans-serif;\u5B8B\u4F53=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},q=async e=>{!e||await e.validate((l,u)=>{l?w():console.log("error submit!",u)})},{isLoading:D,httpRequest:V}=b(),w=()=>{V({url:f(`/api/v1/topics${a.name==="addTopic"?"":"/update"}`),method:"post",data:{topic_id:r.id,title:r.title,content:r.content,tab:"dev",accesstoken:y.value}}).then(({data:e})=>{e!=null&&e.success&&(c.success(a.name==="addTopic"?"\u53D1\u5E03\u6210\u529F":"\u4FEE\u6539\u6210\u529F"),_())}).catch(e=>{c.error(a.name==="addTopic"?"\u53D1\u5E03\u5931\u8D25":"\u4FEE\u6539\u5931\u8D25"),console.error(e)})};return(e,l)=>{const u=z,C=H,N=$,i=U,T=j,P=I,S=M,R=A,L=O;return d(),k("div",ie,[t(Y,null,{right:n(()=>[t(G,{isTopicsRepliesList:!1}),t(J)]),default:n(()=>[t(L,{class:"box-card"},{header:n(()=>{var s;return[t(u,{class:"card-title",onBack:_,content:((s=o(a))==null?void 0:s.name)==="addTopic"?"\u53D1\u5E03\u8BDD\u9898":"\u7F16\u8F91\u8BDD\u9898"},null,8,["content"])]}),default:n(()=>[se("span",ue,[t(R,{class:"edit-skeleton",loading:o(E),animated:"",rows:20},{default:n(()=>[t(S,{ref_key:"form",ref:g,class:"edit-form",model:o(r),rules:o(v),"label-width":"auto","label-position":"top"},{default:n(()=>[t(i,{label:"\u7248\u5757",prop:"tab"},{default:n(()=>[t(N,{modelValue:o(r).tab,"onUpdate:modelValue":l[0]||(l[0]=s=>o(r).tab=s),placeholder:""},{default:n(()=>[(d(!0),k(oe,null,ne(o(W),s=>(d(),le(C,{key:s.key,label:s.name,value:s.key},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(i,{label:"\u6807\u9898",prop:"title"},{default:n(()=>[t(T,{modelValue:o(r).title,"onUpdate:modelValue":l[1]||(l[1]=s=>o(r).title=s)},null,8,["modelValue"])]),_:1}),t(i,{label:"\u5185\u5BB9",prop:"content"},{default:n(()=>[t(o(K),{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:B,modelValue:o(r).content,"onUpdate:modelValue":l[2]||(l[2]=s=>o(r).content=s)},null,8,["modelValue"])]),_:1}),t(i,{class:"is-last"},{default:n(()=>[t(P,{type:"primary",loading:o(D),onClick:l[3]||(l[3]=s=>q(g.value))},{default:n(()=>[ce]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["loading"])])]),_:1})]),_:1})])}}});export{De as default};
