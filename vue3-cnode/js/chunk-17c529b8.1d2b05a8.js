(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-17c529b8"],{"01b1":function(e,t,a){"use strict";a("f05d")},b55f:function(e,t,a){"use strict";a.r(t);a("83b2"),a("809a"),a("7aa1"),a("797a"),a("c4aa"),a("c49e"),a("cc66"),a("10c7"),a("06dd");var n=a("8c98"),o=a("4c02"),c=a("9caa"),i=a("d8e8"),r=a("cf2e"),l=a("c349"),u=a("91c0"),s=a("6d00"),d=a("7a23"),b={class:"edit-topic-body"},p={class:"edit-topic"},m=Object(d["createTextVNode"])("提交");function f(e,t,a,f,j,g){var h=s["a"],O=u["a"],k=u["b"],v=i["b"],x=l["a"],w=Object(d["resolveComponent"])("editor"),C=r["a"],V=i["a"],_=c["a"],N=o["a"],y=Object(d["resolveComponent"])("user-info-comp"),F=Object(d["resolveComponent"])("client-qr-code-comp"),q=n["a"];return Object(d["openBlock"])(),Object(d["createElementBlock"])("div",b,[Object(d["createVNode"])(q,null,{right:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(y,{isTopicsRepliesList:!1}),Object(d["createVNode"])(F)]})),default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(N,{class:"box-card"},{header:Object(d["withCtx"])((function(){var t;return[Object(d["createVNode"])(h,{class:"card-title",onBack:e.goBack,content:"addTopic"===(null===(t=e.route)||void 0===t?void 0:t.name)?"发布话题":"编辑话题"},null,8,["onBack","content"])]})),default:Object(d["withCtx"])((function(){return[Object(d["createElementVNode"])("span",p,[Object(d["createVNode"])(_,{class:"edit-skeleton",loading:e.isLoading,animated:"",rows:20},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(V,{ref:"form",class:"edit-form",model:e.topicForm,rules:e.rules,"label-width":"auto","label-position":"top"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(v,{label:"版块",prop:"tab"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(k,{modelValue:e.topicForm.tab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.topicForm.tab=t}),placeholder:""},{default:Object(d["withCtx"])((function(){return[(Object(d["openBlock"])(!0),Object(d["createElementBlock"])(d["Fragment"],null,Object(d["renderList"])(e.topicTypeList,(function(e){return Object(d["openBlock"])(),Object(d["createBlock"])(O,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(d["createVNode"])(v,{label:"标题",prop:"title"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(x,{modelValue:e.topicForm.title,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.topicForm.title=t})},null,8,["modelValue"])]})),_:1}),Object(d["createVNode"])(v,{label:"内容",prop:"content"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(w,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:e.topicForm.content,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.topicForm.content=t})},null,8,["init","modelValue"])]})),_:1}),Object(d["createVNode"])(v,{class:"is-last"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(C,{type:"primary",loading:e.IsSubmitLoading,onClick:t[3]||(t[3]=function(t){return e.onSubmit(e.form)})},{default:Object(d["withCtx"])((function(){return[m]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["loading"])])]})),_:1})]})),_:1})])}var j=a("9ab4"),g=a("3ef4"),h=a("1420"),O=a("7780"),k=a("ca72"),v=a("93f3"),x=a("6c02"),w=a("b32d"),C=a("5502"),V=a("d257"),_=Object(d["defineComponent"])({components:{ElCard:o["a"],ElPageHeader:s["a"],ElSkeleton:c["a"],ElForm:i["a"],ElFormItem:i["b"],ElSelect:u["b"],ElButton:r["a"],Editor:k["a"],PageWrapper:n["a"],UserInfoComp:h["a"],ClientQrCodeComp:O["a"]},setup:function(){var e=this,t=Object(C["b"])().state,a=Object(d["computed"])((function(){return t.user.token})),n=Object(x["c"])(),o=Object(x["d"])(),c=Object(d["reactive"])({id:void 0,title:"",tab:"",content:""}),i=function(){"addTopic"===n.name?o.push({name:"index",params:{listParm:String(n.query.listParm)}}):o.push({path:"/detail",query:{id:n.params.id,listParm:n.query.listParm}})},r=Object(w["a"])(),l=r.isLoading,u=r.adornUrl,s=r.httpRequest,b=function(){s({url:u("/api/v1/topic/"+n.params.id),method:"get",params:{mdrender:!0,accesstoken:t.user.token||""}}).then((function(e){var t=e.data;t.data.content=Object(V["a"])(t.data.content),Object.assign(c,t.data)})).catch((function(e){g["a"].error("请求失败"),console.error(e)}))};n.params.id&&b();var p=Object(d["ref"])(),m=Object(d["reactive"])({title:[{required:!0,message:"请输入标题",trigger:"blur"}],tab:[{required:!0,message:"请选择版块",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}),f={height:500,width:"100%",language_url:"./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},h=function(t){return Object(j["b"])(e,void 0,void 0,(function(){return Object(j["c"])(this,(function(e){switch(e.label){case 0:return t?[4,t.validate((function(e,t){e?N():console.log("error submit!",t)}))]:[2];case 1:return e.sent(),[2]}}))}))},O=Object(w["a"])(),k=O.isLoading,_=O.httpRequest,N=function(){_({url:u("/api/v1/topics"+("addTopic"===n.name?"":"/update")),method:"post",data:{topic_id:c.id,title:c.title,content:c.content,tab:"dev",accesstoken:a.value}}).then((function(e){var t=e.data;(null===t||void 0===t?void 0:t.success)&&(g["a"].success("addTopic"===n.name?"发布成功":"修改成功"),i())})).catch((function(e){g["a"].error("addTopic"===n.name?"发布失败":"修改失败"),console.error(e)}))};return{goBack:i,route:n,isLoading:l,form:p,topicForm:c,rules:m,init:f,topicTypeList:v["a"].filter((function(e){return!["all","good"].includes(e.key)})),onSubmit:h,IsSubmitLoading:k}}}),N=(a("01b1"),a("6b0d")),y=a.n(N);const F=y()(_,[["render",f]]);t["default"]=F},f05d:function(e,t,a){}}]);
//# sourceMappingURL=chunk-17c529b8.1d2b05a8.js.map