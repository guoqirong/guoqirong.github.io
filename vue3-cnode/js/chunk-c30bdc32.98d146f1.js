(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c30bdc32"],{2580:function(e,t,c){},"3a90":function(e,t,c){"use strict";c("2580")},8248:function(e,t,c){"use strict";c.r(t);c("7aa1"),c("c49e"),c("7a64"),c("83b2"),c("809a"),c("3e9e"),c("797a"),c("06dd");var o=c("8c98"),n=c("d8e8"),a=c("bfd2"),i=c("4c02"),l=c("9caa"),r=c("ae7b"),s=c("cf2e"),u=c("6d00"),d=c("7a23"),p={class:"detail-body"},b=Object(d["createTextVNode"])("编辑话题"),m={class:"my-topic"},f={class:"topic-title"},v={class:"title-left"},j={class:"topic-title-desc"},O={class:"title-right"},h=["innerHTML"],g=Object(d["createElementVNode"])("span",{class:"card-replies-title"},"回复",-1),k={class:"replie-user-img"},C={class:"replie-title"},N={class:"replie-up"},V=["onClick"],y={key:0},w=["onClick"],x={class:"replie-desc"},_=["innerHTML"],E=Object(d["createTextVNode"])("回复"),B=Object(d["createTextVNode"])("取消"),S=Object(d["createElementVNode"])("span",{class:"card-replies-title"},"添加回复",-1),L=Object(d["createTextVNode"])("回复");function R(e,t,c,R,T,q){var z=u["a"],D=s["a"],M=r["a"],F=l["a"],I=i["a"],P=a["a"],H=Object(d["resolveComponent"])("editor"),U=n["b"],A=n["a"],J=Object(d["resolveComponent"])("user-info-comp"),Y=Object(d["resolveComponent"])("client-qr-code-comp"),Q=o["a"];return Object(d["openBlock"])(),Object(d["createElementBlock"])("div",p,[Object(d["createVNode"])(Q,null,{right:Object(d["withCtx"])((function(){var t;return[Object(d["createVNode"])(J,{title:"作者",authorData:null===(t=e.topic)||void 0===t?void 0:t.author,authorLoading:e.isLoading},null,8,["authorData","authorLoading"]),Object(d["createVNode"])(Y)]})),default:Object(d["withCtx"])((function(){var c,o;return[Object(d["createVNode"])(I,{class:"box-card"},{header:Object(d["withCtx"])((function(){var t;return[Object(d["createVNode"])(z,{class:"card-title",onBack:e.goBack,content:"话题详情"},null,8,["onBack"]),e.userName===(null===(t=e.topic)||void 0===t?void 0:t.author.loginname)?(Object(d["openBlock"])(),Object(d["createBlock"])(D,{key:0,class:"edit-topic-btn",type:"primary",onClick:e.editTopic},{default:Object(d["withCtx"])((function(){return[b]})),_:1},8,["onClick"])):Object(d["createCommentVNode"])("",!0)]})),default:Object(d["withCtx"])((function(){var t;return[Object(d["createElementVNode"])("span",m,[Object(d["createVNode"])(F,{class:"detail-skeleton",loading:e.isLoading,animated:"",rows:20},{default:Object(d["withCtx"])((function(){var t,c,o,n,a,i,l,r,s,u,p;return[Object(d["createElementVNode"])("div",f,[Object(d["createElementVNode"])("div",v,[Object(d["createElementVNode"])("div",{class:"topic-title-tab",style:Object(d["normalizeStyle"])({width:(null===(t=e.topic)||void 0===t?void 0:t.top)||"dev"!==(null===(c=e.topic)||void 0===c?void 0:c.tab)?"50px":""})},[Object(d["createVNode"])(M,{effect:"dark",type:(null===(o=e.topic)||void 0===o?void 0:o.top)?"danger":"success"},{default:Object(d["withCtx"])((function(){var t,c;return[Object(d["createTextVNode"])(Object(d["toDisplayString"])(e.getTopicTab(null===(t=e.topic)||void 0===t?void 0:t.top,null===(c=e.topic)||void 0===c?void 0:c.tab)),1)]})),_:1},8,["type"])],4),Object(d["createElementVNode"])("div",{class:"title-name",style:Object(d["normalizeStyle"])({width:(null===(n=e.topic)||void 0===n?void 0:n.top)||"dev"!==(null===(a=e.topic)||void 0===a?void 0:a.tab)?"calc(100% - 50px)":""})},Object(d["toDisplayString"])(null===(i=e.topic)||void 0===i?void 0:i.title),5),Object(d["createElementVNode"])("div",j,[Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])("● "+e.formatDate((null===(l=e.topic)||void 0===l?void 0:l.create_at)||"","yyyy-MM-dd")),1),Object(d["createElementVNode"])("span",null,Object(d["toDisplayString"])("● "+((null===(r=e.topic)||void 0===r?void 0:r.author)&&(null===(s=e.topic)||void 0===s?void 0:s.author.loginname)?null===(u=e.topic)||void 0===u?void 0:u.author.loginname:"")),1)])]),Object(d["createElementVNode"])("div",O,[e.token?(Object(d["openBlock"])(),Object(d["createBlock"])(D,{key:0,circle:"",plain:"",size:"large",type:"warning",icon:(null===(p=e.topic)||void 0===p?void 0:p.is_collect)?e.StarFilled:e.Star,onClick:e.collectClick},null,8,["icon","onClick"])):Object(d["createCommentVNode"])("",!0)])])]})),_:1},8,["loading"]),Object(d["createElementVNode"])("div",{class:"topic-content",innerHTML:null===(t=e.topic)||void 0===t?void 0:t.content},null,8,h)])]})),_:1}),(null===(c=e.topic)||void 0===c?void 0:c.replies)&&(null===(o=e.topic.replies)||void 0===o?void 0:o.length)>0?(Object(d["openBlock"])(),Object(d["createBlock"])(I,{key:0,class:"box-card"},{header:Object(d["withCtx"])((function(){return[g]})),default:Object(d["withCtx"])((function(){var t;return[(Object(d["openBlock"])(!0),Object(d["createElementBlock"])(d["Fragment"],null,Object(d["renderList"])(null===(t=e.topic)||void 0===t?void 0:t.replies,(function(t,c){return Object(d["openBlock"])(),Object(d["createElementBlock"])("div",{key:c,class:"replie-item"},[Object(d["createElementVNode"])("div",k,[Object(d["createVNode"])(P,{shape:"square",size:40,src:t.author.avatar_url},null,8,["src"])]),Object(d["createElementVNode"])("div",C,Object(d["toDisplayString"])(t.author.loginname+"回复了您的话题"),1),Object(d["createElementVNode"])("div",N,[Object(d["createElementVNode"])("div",{class:"icon up-icon",onClick:function(c){return e.likeAndUnlike(t.id)}},null,8,V),t.ups.length?(Object(d["openBlock"])(),Object(d["createElementBlock"])("span",y,Object(d["toDisplayString"])(t.ups.length),1)):Object(d["createCommentVNode"])("",!0)]),Object(d["createElementVNode"])("div",{class:"icon replie-icon",onClick:function(t){return e.changeRepliceItemState(c)}},null,8,w),Object(d["createElementVNode"])("div",x,Object(d["toDisplayString"])(e.formatDate(t.create_at,"yyyy-MM-dd")),1),Object(d["createElementVNode"])("div",{class:"replie-content",innerHTML:null===t||void 0===t?void 0:t.content},null,8,_),t.isReplie?(Object(d["openBlock"])(),Object(d["createBlock"])(A,{key:0,ref_for:!0,ref:function(e){return t.formRef=e},class:"replies-form replie-edit-wrapper",model:t,rules:e.rules,"label-width":"0"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(U,{label:"",prop:"replieContent"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(H,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:t.replieContent,"onUpdate:modelValue":function(e){return t.replieContent=e}},null,8,["init","modelValue","onUpdate:modelValue"])]})),_:2},1024),Object(d["createVNode"])(U,{class:"is-last"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(D,{type:"primary",onClick:function(c){return e.replieTopic(t.formRef,t.id,t.replieContent)}},{default:Object(d["withCtx"])((function(){return[E]})),_:2},1032,["onClick"]),Object(d["createVNode"])(D,{onClick:function(t){return e.changeRepliceItemState(c)}},{default:Object(d["withCtx"])((function(){return[B]})),_:2},1032,["onClick"])]})),_:2},1024)]})),_:2},1032,["model","rules"])):Object(d["createCommentVNode"])("",!0)])})),128))]})),_:1})):Object(d["createCommentVNode"])("",!0),Object(d["createVNode"])(I,{class:"box-card"},{header:Object(d["withCtx"])((function(){return[S]})),default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(A,{ref:"form",class:"replies-form",model:e.topicReplieForm,rules:e.rules,"label-width":"0"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(U,{label:"",prop:"content"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(H,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:e.topicReplieForm.content,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.topicReplieForm.content=t})},null,8,["init","modelValue"])]})),_:1}),Object(d["createVNode"])(U,{class:"is-last"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(D,{type:"primary",onClick:t[1]||(t[1]=function(t){return e.replieTopic(e.form)})},{default:Object(d["withCtx"])((function(){return[L]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:1})]})),_:1})])}var T=c("9ab4"),q=c("1420"),z=c("7780"),D=c("b32d"),M=c("6c02"),F=c("5502"),I=c("3ef4"),P=c("9ee5");const H=Object(d["defineComponent"])({name:"Star"}),U={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},A=Object(d["createElementVNode"])("path",{fill:"currentColor",d:"M512 747.84l228.16 119.936a6.4 6.4 0 009.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 00-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 00-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 00-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 009.28 6.72L512 747.84zM313.6 924.48a70.4 70.4 0 01-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 01128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 01126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0139.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 01-102.144 74.24L512 820.096l-198.4 104.32z"},null,-1),J=[A];function Y(e,t,c,o,n,a){return Object(d["openBlock"])(),Object(d["createElementBlock"])("svg",U,J)}var Q=Object(P["a"])(H,[["render",Y]]);const W=Object(d["defineComponent"])({name:"StarFilled"}),G={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},K=Object(d["createElementVNode"])("path",{fill:"currentColor",d:"M283.84 867.84L512 747.776l228.16 119.936a6.4 6.4 0 009.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 00-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 00-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 00-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 009.28 6.72z"},null,-1),X=[K];function Z(e,t,c,o,n,a){return Object(d["openBlock"])(),Object(d["createElementBlock"])("svg",G,X)}var $=Object(P["a"])(W,[["render",Z]]),ee=c("d257"),te=c("ca72"),ce=Object(d["defineComponent"])({components:{ElCard:i["a"],ElPageHeader:u["a"],ElButton:s["a"],ElAvatar:a["a"],ElSkeleton:l["a"],ElForm:n["a"],ElFormItem:n["b"],Editor:te["a"],PageWrapper:o["a"],UserInfoComp:q["a"],ClientQrCodeComp:z["a"]},setup:function(){var e=this,t=Object(M["c"])(),c=Object(M["d"])(),o=Object(F["b"])().state,n={height:200,width:"100%",language_url:"./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},a=Object(d["computed"])((function(){return o.user.simpleUserData.loginname})),i=Object(D["a"])(),l=i.isLoading,r=i.adornUrl,s=i.httpRequest,u=Object(d["ref"])(),p=function(){s({url:r("/api/v1/topic/"+t.query.id),method:"get",params:{mdrender:!0,accesstoken:o.user.token||""}}).then((function(e){var t=e.data;t.data.content=Object(ee["a"])(t.data.content),t.data.replies.forEach((function(e){e.content=Object(ee["a"])(e.content),e.isReplie=!1,e.formRef=Object(d["ref"])(),e.replieContent=""})),u.value=t.data})).catch((function(e){I["a"].error("请求失败"),console.error(e)}))};p();var b=function(){t.query.listParm?c.push({name:"index",params:{listParm:String(t.query.listParm)}}):t.query.userName?c.push("/user/"+t.query.userName):c.push("/collect")},m=function(){var e;c.push({path:"/edit-topic/"+(null===(e=u.value)||void 0===e?void 0:e.id),query:{listParm:String(t.query.listParm)}})},f=Object(D["a"])().httpRequest,v=function(){u.value&&u.value.is_collect?O():j()},j=function(){f({url:r("/api/v1/topic_collect/collect"),method:"post",data:{topic_id:u.value&&u.value.id,accesstoken:localStorage.getItem("token")||""}}).then((function(){u.value&&(u.value.is_collect=!0),I["a"].success("收藏成功")})).catch((function(e){I["a"].error("请求失败"),console.error(e)}))},O=function(){f({url:r("/api/v1/topic_collect/de_collect"),method:"post",data:{topic_id:u.value&&u.value.id,accesstoken:localStorage.getItem("token")||""}}).then((function(){u.value&&(u.value.is_collect=!1),I["a"].success("取消收藏成功")})).catch((function(e){I["a"].error("请求失败"),console.error(e)}))},h=Object(D["a"])().httpRequest,g=function(e){h({url:r("/api/v1/reply/"+e+"/ups"),method:"post",data:{accesstoken:localStorage.getItem("token")||""}}).then((function(e){var t=e.data;"up"===t.action?I["a"].success("点赞成功"):I["a"].success("取消点赞成功"),p()})).catch((function(e){var t=e.response.data;t.error_msg?I["a"].error(t.error_msg):(I["a"].error("请求失败"),console.error(e))}))},k=Object(d["ref"])(),C=Object(d["reactive"])({id:void 0,content:""}),N=Object(d["reactive"])({content:[{required:!0,message:"请输入内容",trigger:"blur"}],replieContent:[{required:!0,message:"请输入内容",trigger:"blur"}]}),V=Object(D["a"])().httpRequest,y=function(t,c,o){return Object(T["b"])(e,void 0,void 0,(function(){return Object(T["c"])(this,(function(e){switch(e.label){case 0:return t?[4,t.validate((function(e,t){e?w(c,o):console.log("error submit!",t)}))]:[2];case 1:return e.sent(),[2]}}))}))},w=function(e,t){var c;V({url:r("/api/v1/topic/"+(null===(c=u.value)||void 0===c?void 0:c.id)+"/replies"),method:"post",data:{accesstoken:localStorage.getItem("token")||"",content:null!==t&&void 0!==t?t:C.content,reply_id:e}}).then((function(){C.content="",p()})).catch((function(e){I["a"].error("请求失败"),console.error(e)}))},x=function(e){var t;if(u.value){var c=null===(t=u.value)||void 0===t?void 0:t.replies,o=c[e].author.loginname;c[e].isReplie=!c[e].isReplie,c[e].replieContent=c[e].isReplie?'<div class="markdown-text"><p><a href="/user/'+o+'">@'+o+"</a>&nbsp;</p></div>":"",u.value=Object(T["a"])(Object(T["a"])({},u.value),{replies:c})}};return{userName:a,editTopic:m,topic:u,isLoading:l,token:o.user.token,Star:Q,StarFilled:$,formatDate:ee["b"],getTopicTab:ee["c"],goBack:b,collectClick:v,likeAndUnlike:g,init:n,form:k,topicReplieForm:C,rules:N,replieTopic:y,changeRepliceItemState:x,replieTopicRequest:w}}}),oe=(c("3a90"),c("6b0d")),ne=c.n(oe);const ae=ne()(ce,[["render",R]]);t["default"]=ae}}]);
//# sourceMappingURL=chunk-c30bdc32.98d146f1.js.map