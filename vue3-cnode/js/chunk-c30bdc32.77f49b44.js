(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c30bdc32"],{2580:function(e,t,c){},"3a90":function(e,t,c){"use strict";c("2580")},8248:function(e,t,c){"use strict";c.r(t);c("7aa1"),c("c49e"),c("7a64"),c("83b2"),c("809a"),c("3e9e"),c("797a"),c("06dd");var o=c("8c98"),n=c("d8e8"),a=c("bfd2"),i=c("4c02"),l=c("9caa"),r=c("ae7b"),s=c("cf2e"),d=c("6d00"),u=c("7a23"),p={class:"detail-body"},b=Object(u["createTextVNode"])("编辑话题"),m={class:"my-topic"},v={class:"topic-title"},j={class:"title-left"},f={class:"topic-title-desc"},O={class:"title-right"},h=["innerHTML"],g=Object(u["createElementVNode"])("span",{class:"card-replies-title"},"回复",-1),k={class:"replie-user-img"},C={class:"replie-title"},y={class:"replie-up"},N=["onClick"],V={key:0},x=["onClick"],w={class:"replie-desc"},_=["innerHTML"],E={key:0,class:"replie-edit-wrapper"},B=Object(u["createTextVNode"])("回复"),S=Object(u["createTextVNode"])("取消"),L=Object(u["createElementVNode"])("span",{class:"card-replies-title"},"添加回复",-1),T=Object(u["createTextVNode"])("回复");function R(e,t,c,R,q,z){var D=d["a"],M=s["a"],F=r["a"],I=l["a"],P=i["a"],H=a["a"],U=Object(u["resolveComponent"])("editor"),A=n["b"],J=n["a"],Y=Object(u["resolveComponent"])("user-info-comp"),Q=Object(u["resolveComponent"])("client-qr-code-comp"),W=o["a"];return Object(u["openBlock"])(),Object(u["createElementBlock"])("div",p,[Object(u["createVNode"])(W,null,{right:Object(u["withCtx"])((function(){var t;return[Object(u["createVNode"])(Y,{title:"作者",authorData:null===(t=e.topic)||void 0===t?void 0:t.author,authorLoading:e.isLoading},null,8,["authorData","authorLoading"]),Object(u["createVNode"])(Q)]})),default:Object(u["withCtx"])((function(){var c,o;return[Object(u["createVNode"])(P,{class:"box-card"},{header:Object(u["withCtx"])((function(){var t;return[Object(u["createVNode"])(D,{class:"card-title",onBack:e.goBack,content:"话题详情"},null,8,["onBack"]),e.userName===(null===(t=e.topic)||void 0===t?void 0:t.author.loginname)?(Object(u["openBlock"])(),Object(u["createBlock"])(M,{key:0,class:"edit-topic-btn",type:"primary",onClick:e.editTopic},{default:Object(u["withCtx"])((function(){return[b]})),_:1},8,["onClick"])):Object(u["createCommentVNode"])("",!0)]})),default:Object(u["withCtx"])((function(){var t;return[Object(u["createElementVNode"])("span",m,[Object(u["createVNode"])(I,{class:"detail-skeleton",loading:e.isLoading,animated:"",rows:20},{default:Object(u["withCtx"])((function(){var t,c,o,n,a,i,l,r,s,d,p;return[Object(u["createElementVNode"])("div",v,[Object(u["createElementVNode"])("div",j,[Object(u["createElementVNode"])("div",{class:"topic-title-tab",style:Object(u["normalizeStyle"])({width:(null===(t=e.topic)||void 0===t?void 0:t.top)||"dev"!==(null===(c=e.topic)||void 0===c?void 0:c.tab)?"50px":""})},[Object(u["createVNode"])(F,{effect:"dark",type:(null===(o=e.topic)||void 0===o?void 0:o.top)?"danger":"success"},{default:Object(u["withCtx"])((function(){var t,c;return[Object(u["createTextVNode"])(Object(u["toDisplayString"])(e.getTopicTab(null===(t=e.topic)||void 0===t?void 0:t.top,null===(c=e.topic)||void 0===c?void 0:c.tab)),1)]})),_:1},8,["type"])],4),Object(u["createElementVNode"])("div",{class:"title-name",style:Object(u["normalizeStyle"])({width:(null===(n=e.topic)||void 0===n?void 0:n.top)||"dev"!==(null===(a=e.topic)||void 0===a?void 0:a.tab)?"calc(100% - 50px)":""})},Object(u["toDisplayString"])(null===(i=e.topic)||void 0===i?void 0:i.title),5),Object(u["createElementVNode"])("div",f,[Object(u["createElementVNode"])("span",null,Object(u["toDisplayString"])("● "+e.formatDate((null===(l=e.topic)||void 0===l?void 0:l.create_at)||"","yyyy-MM-dd")),1),Object(u["createElementVNode"])("span",null,Object(u["toDisplayString"])("● "+((null===(r=e.topic)||void 0===r?void 0:r.author)&&(null===(s=e.topic)||void 0===s?void 0:s.author.loginname)?null===(d=e.topic)||void 0===d?void 0:d.author.loginname:"")),1)])]),Object(u["createElementVNode"])("div",O,[e.token?(Object(u["openBlock"])(),Object(u["createBlock"])(M,{key:0,circle:"",plain:"",size:"large",type:"warning",icon:(null===(p=e.topic)||void 0===p?void 0:p.is_collect)?e.StarFilled:e.Star,onClick:e.collectClick},null,8,["icon","onClick"])):Object(u["createCommentVNode"])("",!0)])])]})),_:1},8,["loading"]),Object(u["createElementVNode"])("div",{class:"topic-content",innerHTML:null===(t=e.topic)||void 0===t?void 0:t.content},null,8,h)])]})),_:1}),(null===(c=e.topic)||void 0===c?void 0:c.replies)&&(null===(o=e.topic.replies)||void 0===o?void 0:o.length)>0?(Object(u["openBlock"])(),Object(u["createBlock"])(P,{key:0,class:"box-card"},{header:Object(u["withCtx"])((function(){return[g]})),default:Object(u["withCtx"])((function(){var t;return[(Object(u["openBlock"])(!0),Object(u["createElementBlock"])(u["Fragment"],null,Object(u["renderList"])(null===(t=e.topic)||void 0===t?void 0:t.replies,(function(t,c){return Object(u["openBlock"])(),Object(u["createElementBlock"])("div",{key:c,class:"replie-item"},[Object(u["createElementVNode"])("div",k,[Object(u["createVNode"])(H,{shape:"square",size:40,src:t.author.avatar_url},null,8,["src"])]),Object(u["createElementVNode"])("div",C,Object(u["toDisplayString"])(t.author.loginname+"回复了您的话题"),1),Object(u["createElementVNode"])("div",y,[Object(u["createElementVNode"])("div",{class:"icon up-icon",onClick:function(c){return e.likeAndUnlike(t.id)}},null,8,N),t.ups.length?(Object(u["openBlock"])(),Object(u["createElementBlock"])("span",V,Object(u["toDisplayString"])(t.ups.length),1)):Object(u["createCommentVNode"])("",!0)]),Object(u["createElementVNode"])("div",{class:"icon replie-icon",onClick:function(t){return e.changeRepliceItemState(c)}},null,8,x),Object(u["createElementVNode"])("div",w,Object(u["toDisplayString"])(e.formatDate(t.create_at,"yyyy-MM-dd")),1),Object(u["createElementVNode"])("div",{class:"replie-content",innerHTML:null===t||void 0===t?void 0:t.content},null,8,_),t.isReplie?(Object(u["openBlock"])(),Object(u["createElementBlock"])("div",E,[Object(u["createVNode"])(U,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:t.replieContent,"onUpdate:modelValue":function(e){return t.replieContent=e}},null,8,["init","modelValue","onUpdate:modelValue"]),Object(u["createVNode"])(M,{type:"primary",onClick:function(c){return e.replieTopicRequest(t.id,t.replieContent)}},{default:Object(u["withCtx"])((function(){return[B]})),_:2},1032,["onClick"]),Object(u["createVNode"])(M,{onClick:function(t){return e.changeRepliceItemState(c)}},{default:Object(u["withCtx"])((function(){return[S]})),_:2},1032,["onClick"])])):Object(u["createCommentVNode"])("",!0)])})),128))]})),_:1})):Object(u["createCommentVNode"])("",!0),Object(u["createVNode"])(P,{class:"box-card"},{header:Object(u["withCtx"])((function(){return[L]})),default:Object(u["withCtx"])((function(){return[Object(u["createVNode"])(J,{ref:"form",class:"replies-form",model:e.topicReplieForm,rules:e.rules,"label-width":"0"},{default:Object(u["withCtx"])((function(){return[Object(u["createVNode"])(A,{label:"",prop:"content"},{default:Object(u["withCtx"])((function(){return[Object(u["createVNode"])(U,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:e.topicReplieForm.content,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.topicReplieForm.content=t})},null,8,["init","modelValue"])]})),_:1}),Object(u["createVNode"])(A,{class:"is-last"},{default:Object(u["withCtx"])((function(){return[Object(u["createVNode"])(M,{type:"primary",onClick:t[1]||(t[1]=function(t){return e.replieTopic(e.form)})},{default:Object(u["withCtx"])((function(){return[T]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:1})]})),_:1})])}var q=c("9ab4"),z=c("1420"),D=c("7780"),M=c("b32d"),F=c("6c02"),I=c("5502"),P=c("3ef4"),H=c("9ee5");const U=Object(u["defineComponent"])({name:"Star"}),A={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},J=Object(u["createElementVNode"])("path",{fill:"currentColor",d:"M512 747.84l228.16 119.936a6.4 6.4 0 009.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 00-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 00-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 00-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 009.28 6.72L512 747.84zM313.6 924.48a70.4 70.4 0 01-102.144-74.24l37.888-220.928L88.96 472.96A70.4 70.4 0 01128 352.896l221.76-32.256 99.2-200.96a70.4 70.4 0 01126.208 0l99.2 200.96 221.824 32.256a70.4 70.4 0 0139.04 120.064L774.72 629.376l37.888 220.928a70.4 70.4 0 01-102.144 74.24L512 820.096l-198.4 104.32z"},null,-1),Y=[J];function Q(e,t,c,o,n,a){return Object(u["openBlock"])(),Object(u["createElementBlock"])("svg",A,Y)}var W=Object(H["a"])(U,[["render",Q]]);const G=Object(u["defineComponent"])({name:"StarFilled"}),K={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},X=Object(u["createElementVNode"])("path",{fill:"currentColor",d:"M283.84 867.84L512 747.776l228.16 119.936a6.4 6.4 0 009.28-6.72l-43.52-254.08 184.512-179.904a6.4 6.4 0 00-3.52-10.88l-255.104-37.12L517.76 147.904a6.4 6.4 0 00-11.52 0L392.192 379.072l-255.104 37.12a6.4 6.4 0 00-3.52 10.88L318.08 606.976l-43.584 254.08a6.4 6.4 0 009.28 6.72z"},null,-1),Z=[X];function $(e,t,c,o,n,a){return Object(u["openBlock"])(),Object(u["createElementBlock"])("svg",K,Z)}var ee=Object(H["a"])(G,[["render",$]]),te=c("d257"),ce=c("ca72"),oe=Object(u["defineComponent"])({components:{ElCard:i["a"],ElPageHeader:d["a"],ElButton:s["a"],ElAvatar:a["a"],ElSkeleton:l["a"],ElForm:n["a"],ElFormItem:n["b"],Editor:ce["a"],PageWrapper:o["a"],UserInfoComp:z["a"],ClientQrCodeComp:D["a"]},setup:function(){var e=this,t=Object(F["c"])(),c=Object(F["d"])(),o=Object(I["b"])().state,n={height:200,width:"100%",language_url:"./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},a=Object(u["computed"])((function(){return o.user.simpleUserData.loginname})),i=Object(M["a"])(),l=i.isLoading,r=i.adornUrl,s=i.httpRequest,d=Object(u["ref"])(),p=function(){s({url:r("/api/v1/topic/"+t.query.id),method:"get",params:{mdrender:!0,accesstoken:o.user.token||""}}).then((function(e){var t=e.data;t.data.content=Object(te["a"])(t.data.content),t.data.replies.forEach((function(e){e.content=Object(te["a"])(e.content),e.isReplie=!1,e.replieContent=""})),d.value=t.data})).catch((function(e){P["a"].error("请求失败"),console.error(e)}))};p();var b=function(){t.query.listParm?c.push({name:"index",params:{listParm:String(t.query.listParm)}}):t.query.userName?c.push("/user/"+t.query.userName):c.push("/collect")},m=function(){var e;c.push({path:"/edit-topic/"+(null===(e=d.value)||void 0===e?void 0:e.id),query:{listParm:String(t.query.listParm)}})},v=Object(M["a"])().httpRequest,j=function(){d.value&&d.value.is_collect?O():f()},f=function(){v({url:r("/api/v1/topic_collect/collect"),method:"post",data:{topic_id:d.value&&d.value.id,accesstoken:localStorage.getItem("token")||""}}).then((function(){d.value&&(d.value.is_collect=!0),P["a"].success("收藏成功")})).catch((function(e){P["a"].error("请求失败"),console.error(e)}))},O=function(){v({url:r("/api/v1/topic_collect/de_collect"),method:"post",data:{topic_id:d.value&&d.value.id,accesstoken:localStorage.getItem("token")||""}}).then((function(){d.value&&(d.value.is_collect=!1),P["a"].success("取消收藏成功")})).catch((function(e){P["a"].error("请求失败"),console.error(e)}))},h=Object(M["a"])().httpRequest,g=function(e){h({url:r("/api/v1/reply/"+e+"/ups"),method:"post",data:{accesstoken:localStorage.getItem("token")||""}}).then((function(e){var t=e.data;"up"===t.action?P["a"].success("点赞成功"):P["a"].success("取消点赞成功"),p()})).catch((function(e){var t=e.response.data;t.error_msg?P["a"].error(t.error_msg):(P["a"].error("请求失败"),console.error(e))}))},k=Object(u["ref"])(),C=Object(u["reactive"])({id:void 0,content:""}),y=Object(u["reactive"])({content:[{required:!0,message:"请输入内容",trigger:"blur"}]}),N=Object(M["a"])().httpRequest,V=function(t){return Object(q["b"])(e,void 0,void 0,(function(){return Object(q["c"])(this,(function(e){switch(e.label){case 0:return t?[4,t.validate((function(e,t){e?x():console.log("error submit!",t)}))]:[2];case 1:return e.sent(),[2]}}))}))},x=function(e,t){var c;N({url:r("/api/v1/topic/"+(null===(c=d.value)||void 0===c?void 0:c.id)+"/replies"),method:"post",data:{accesstoken:localStorage.getItem("token")||"",content:null!==t&&void 0!==t?t:C.content,reply_id:e}}).then((function(){C.content="",p()})).catch((function(e){P["a"].error("请求失败"),console.error(e)}))},w=function(e){var t;if(d.value){var c=null===(t=d.value)||void 0===t?void 0:t.replies,o=c[e].author.loginname;c[e].isReplie=!c[e].isReplie,c[e].replieContent=c[e].isReplie?'<div class="markdown-text"><p><a href="/user/'+o+'">@'+o+"</a>&nbsp;</p></div>":"",d.value=Object(q["a"])(Object(q["a"])({},d.value),{replies:c})}};return{userName:a,editTopic:m,topic:d,isLoading:l,token:o.user.token,Star:W,StarFilled:ee,formatDate:te["b"],getTopicTab:te["c"],goBack:b,collectClick:j,likeAndUnlike:g,init:n,form:k,topicReplieForm:C,rules:y,replieTopic:V,changeRepliceItemState:w,replieTopicRequest:x}}}),ne=(c("3a90"),c("6b0d")),ae=c.n(ne);const ie=ae()(oe,[["render",R]]);t["default"]=ie}}]);
//# sourceMappingURL=chunk-c30bdc32.77f49b44.js.map