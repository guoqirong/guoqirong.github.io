(window["webpackJsonp_vue3-cnode"]=window["webpackJsonp_vue3-cnode"]||[]).push([["chunk-52e07ad6"],{"01b1":function(e,t,n){"use strict";n("f05d")},"06dd":function(e,t,n){"use strict";n("771d"),n("4ba3")},"4ba3":function(e,t,n){},"6d00":function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var o=n("7a23"),i=n("54bb"),c=n("7bc7");const a={icon:{type:[String,Object],default:c["Back"]},title:String,content:{type:String,default:""}},r={back:()=>!0};var l=n("2711"),u=n("4cb3"),s=n("304f");const d=Object(o["defineComponent"])({name:"ElPageHeader",components:{ElIcon:i["a"]},props:a,emits:r,setup(e,{emit:t}){const{t:n}=Object(u["a"])(),o=Object(s["a"])("page-header");function i(){t("back")}return{handleClick:i,t:n,ns:o}}});function b(e,t,n,i,c,a){const r=Object(o["resolveComponent"])("el-icon");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(e.ns.b())},[Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(e.ns.e("left")),onClick:t[0]||(t[0]=(...t)=>e.handleClick&&e.handleClick(...t))},[e.icon||e.$slots.icon?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:0,class:Object(o["normalizeClass"])(e.ns.e("icon"))},[Object(o["renderSlot"])(e.$slots,"icon",{},()=>[e.icon?(Object(o["openBlock"])(),Object(o["createBlock"])(r,{key:0},{default:Object(o["withCtx"])(()=>[(Object(o["openBlock"])(),Object(o["createBlock"])(Object(o["resolveDynamicComponent"])(e.icon)))]),_:1})):Object(o["createCommentVNode"])("v-if",!0)])],2)):Object(o["createCommentVNode"])("v-if",!0),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(e.ns.e("title"))},[Object(o["renderSlot"])(e.$slots,"title",{},()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.title||e.t("el.pageHeader.title")),1)])],2)],2),Object(o["createElementVNode"])("div",{class:Object(o["normalizeClass"])(e.ns.e("content"))},[Object(o["renderSlot"])(e.$slots,"content",{},()=>[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.content),1)])],2)],2)}var f=Object(l["a"])(d,[["render",b]]),p=n("0c24");const m=Object(p["a"])(f)},b55f:function(e,t,n){"use strict";n.r(t);n("83b2"),n("809a"),n("7aa1"),n("797a"),n("c4aa"),n("c49e"),n("cc66"),n("10c7"),n("06dd");var o=n("8c98"),i=n("4c02"),c=n("9caa"),a=n("d8e8"),r=n("cf2e"),l=n("c349"),u=n("91c0"),s=n("6d00"),d=n("7a23"),b={class:"edit-topic-body"},f={class:"edit-topic"},p=Object(d["createTextVNode"])("提交");function m(e,t,n,m,j,O){var v=s["a"],g=u["a"],h=u["b"],y=a["b"],C=l["a"],k=Object(d["resolveComponent"])("editor"),w=r["a"],S=a["a"],x=c["a"],V=i["a"],N=Object(d["resolveComponent"])("user-info-comp"),B=Object(d["resolveComponent"])("client-qr-code-comp"),E=o["a"];return Object(d["openBlock"])(),Object(d["createElementBlock"])("div",b,[Object(d["createVNode"])(E,null,{right:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(N,{isTopicsRepliesList:!1}),Object(d["createVNode"])(B)]})),default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(V,{class:"box-card"},{header:Object(d["withCtx"])((function(){var t;return[Object(d["createVNode"])(v,{class:"card-title",onBack:e.goBack,content:"addTopic"===(null===(t=e.route)||void 0===t?void 0:t.name)?"发布话题":"编辑话题"},null,8,["onBack","content"])]})),default:Object(d["withCtx"])((function(){return[Object(d["createElementVNode"])("span",f,[Object(d["createVNode"])(x,{class:"edit-skeleton",loading:e.isLoading,animated:"",rows:20},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(S,{ref:"form",class:"edit-form",model:e.topicForm,rules:e.rules,"label-width":"auto","label-position":"top"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(y,{label:"版块",prop:"tab"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(h,{modelValue:e.topicForm.tab,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.topicForm.tab=t}),placeholder:""},{default:Object(d["withCtx"])((function(){return[(Object(d["openBlock"])(!0),Object(d["createElementBlock"])(d["Fragment"],null,Object(d["renderList"])(e.topicTypeList,(function(e){return Object(d["openBlock"])(),Object(d["createBlock"])(g,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(d["createVNode"])(y,{label:"标题",prop:"title"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(C,{modelValue:e.topicForm.title,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.topicForm.title=t})},null,8,["modelValue"])]})),_:1}),Object(d["createVNode"])(y,{label:"内容",prop:"content"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(k,{"api-key":"mh2f2ffdlr2zzaky3yk52tx8rtxrxnbt1a6p7p7jx96hy70r",init:e.init,modelValue:e.topicForm.content,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.topicForm.content=t})},null,8,["init","modelValue"])]})),_:1}),Object(d["createVNode"])(y,{class:"is-last"},{default:Object(d["withCtx"])((function(){return[Object(d["createVNode"])(w,{type:"primary",loading:e.IsSubmitLoading,onClick:t[3]||(t[3]=function(t){return e.onSubmit(e.form)})},{default:Object(d["withCtx"])((function(){return[p]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["loading"])])]})),_:1})]})),_:1})])}var j=n("9ab4"),O=n("3ef4"),v=n("1420"),g=n("7780"),h=n("ca72"),y=n("93f3"),C=n("6c02"),k=n("b32d"),w=n("5502"),S=n("d257"),x=Object(d["defineComponent"])({components:{ElCard:i["a"],ElPageHeader:s["a"],ElSkeleton:c["a"],ElForm:a["a"],ElFormItem:a["b"],ElSelect:u["b"],ElButton:r["a"],Editor:h["a"],PageWrapper:o["a"],UserInfoComp:v["a"],ClientQrCodeComp:g["a"]},setup:function(){var e=this,t=Object(w["b"])().state,n=Object(d["computed"])((function(){return t.user.token})),o=Object(C["c"])(),i=Object(C["d"])(),c=Object(d["reactive"])({id:void 0,title:"",tab:"",content:""}),a=function(){"addTopic"===o.name?i.push({name:"index",params:{listParm:String(o.query.listParm)}}):i.push({path:"/detail",query:{id:o.params.id,listParm:o.query.listParm}})},r=Object(k["a"])(),l=r.isLoading,u=r.adornUrl,s=r.httpRequest,b=function(){s({url:u("/api/v1/topic/"+o.params.id),method:"get",params:{mdrender:!0,accesstoken:t.user.token||""}}).then((function(e){var t=e.data;t.data.content=Object(S["a"])(t.data.content),Object.assign(c,t.data)})).catch((function(e){O["a"].error("请求失败"),console.error(e)}))};o.params.id&&b();var f=Object(d["ref"])(),p=Object(d["reactive"])({title:[{required:!0,message:"请输入标题",trigger:"blur"}],tab:[{required:!0,message:"请选择版块",trigger:"change"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]}),m={height:500,width:"100%",language_url:"./tinymce-langs/zh_CN.js",language:"zh_CN",browser_spellcheck:!0,branding:!1,elementpath:!0,statusbar:!0,paste_data_images:!0,menubar:!1,fontsize_formats:"14px 16px 18px 20px 24px 26px 28px 30px 32px 36px",font_formats:"微软雅黑=Microsoft YaHei,Helvetica Neue;PingFang SC;sans-serif;苹果苹方=PingFang SC,Microsoft YaHei,sans-serif;宋体=simsun;serifsans-serif;Terminal=terminal;monaco;Times New Roman=times new roman;times",file_picker_types:"image",images_upload_credentials:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"fontselect fontsizeselect link lineheight forecolor backcolor bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | image quicklink h2 h3 blockquote table numlist bullist preview fullscreen"},v=function(t){return Object(j["b"])(e,void 0,void 0,(function(){return Object(j["c"])(this,(function(e){switch(e.label){case 0:return t?[4,t.validate((function(e,t){e?V():console.log("error submit!",t)}))]:[2];case 1:return e.sent(),[2]}}))}))},g=Object(k["a"])(),h=g.isLoading,x=g.httpRequest,V=function(){x({url:u("/api/v1/topics"+("addTopic"===o.name?"":"/update")),method:"post",data:{topic_id:c.id,title:c.title,content:c.content,tab:"dev",accesstoken:n.value}}).then((function(e){var t=e.data;(null===t||void 0===t?void 0:t.success)&&(O["a"].success("addTopic"===o.name?"发布成功":"修改成功"),a())})).catch((function(e){O["a"].error("addTopic"===o.name?"发布失败":"修改失败"),console.error(e)}))};return{goBack:a,route:o,isLoading:l,form:f,topicForm:c,rules:p,init:m,topicTypeList:y["a"].filter((function(e){return!["all","good"].includes(e.key)})),onSubmit:v,IsSubmitLoading:h}}}),V=(n("01b1"),n("6b0d")),N=n.n(V);const B=N()(x,[["render",m]]);t["default"]=B},c4a9:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));var o=function(){return"undefined"!==typeof window?window:e},i=function(){var e=o();return e&&e.tinymce?e.tinymce:null}}).call(this,n("c8ba"))},ca72:function(e,t,n){"use strict";var o=n("7a23"),i=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],c=function(e){return-1!==i.map((function(e){return e.toLowerCase()})).indexOf(e.toLowerCase())},a=function(e,t,n){Object.keys(t).filter(c).forEach((function(o){var i=t[o];"function"===typeof i&&("onInit"===o?i(e,n):n.on(o.substring(2),(function(e){return i(e,n)})))}))},r=function(e,t,n,i){var c=e.modelEvents?e.modelEvents:null,a=Array.isArray(c)?c.join(" "):c;Object(o["watch"])(i,(function(t,o){n&&"string"===typeof t&&t!==o&&t!==n.getContent({format:e.outputFormat})&&n.setContent(t)})),n.on(a||"change input undo redo",(function(){t.emit("update:modelValue",n.getContent({format:e.outputFormat}))}))},l=function(e,t,n,o,i,c){o.setContent(c()),n.attrs["onUpdate:modelValue"]&&r(t,n,o,i),a(e,n.attrs,o)},u=0,s=function(e){var t=Date.now(),n=Math.floor(1e9*Math.random());return u++,e+"_"+n+u+String(t)},d=function(e){return null!==e&&"textarea"===e.tagName.toLowerCase()},b=function(e){return"undefined"===typeof e||""===e?[]:Array.isArray(e)?e:e.split(" ")},f=function(e,t){return b(e).concat(b(t))},p=function(e){return null===e||void 0===e},m=function(){return{listeners:[],scriptId:s("tiny-script"),scriptLoaded:!1}},j=function(){var e=m(),t=function(e,t,n,o){var i=t.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=e,i.src=n;var c=function(){i.removeEventListener("load",c),o()};i.addEventListener("load",c),t.head&&t.head.appendChild(i)},n=function(n,o,i){e.scriptLoaded?i():(e.listeners.push(i),n.getElementById(e.scriptId)||t(e.scriptId,n,o,(function(){e.listeners.forEach((function(e){return e()})),e.scriptLoaded=!0})))},o=function(){e=m()};return{load:n,reinitialize:o}},O=j(),v=n("c4a9"),g={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return"html"===e||"text"===e}}},h=function(){return h=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h.apply(this,arguments)},y=function(e,t,n,o){return e(o||"div",{id:t,ref:n})},C=function(e,t,n){return e("textarea",{id:t,visibility:"hidden",ref:n})},k=Object(o["defineComponent"])({props:g,setup:function(e,t){var n=e.init?h({},e.init):{},i=Object(o["toRefs"])(e),c=i.disabled,a=i.modelValue,r=i.tagName,u=Object(o["ref"])(null),b=null,m=e.id||s("tiny-vue"),j=e.init&&e.init.inline||e.inline,g=!!t.attrs["onUpdate:modelValue"],k=!0,w=e.initialValue?e.initialValue:"",S="",x=function(e){return g?function(){return(null===a||void 0===a?void 0:a.value)?a.value:""}:function(){return e?w:S}},V=function(){var o=x(k),i=h(h({},n),{readonly:e.disabled,selector:"#"+m,plugins:f(n.plugins,e.plugins),toolbar:e.toolbar||n.toolbar,inline:j,setup:function(i){b=i,i.on("init",(function(n){return l(n,e,t,i,a,o)})),"function"===typeof n.setup&&n.setup(i)}});d(u.value)&&(u.value.style.visibility=""),Object(v["a"])().init(i),k=!1};Object(o["watch"])(c,(function(e){var t;null!==b&&("function"===typeof(null===(t=b.mode)||void 0===t?void 0:t.set)?b.mode.set(e?"readonly":"design"):b.setMode(e?"readonly":"design"))})),Object(o["watch"])(r,(function(e){var t;g||(S=b.getContent()),null===(t=Object(v["a"])())||void 0===t||t.remove(b),Object(o["nextTick"])((function(){return V()}))})),Object(o["onMounted"])((function(){if(null!==Object(v["a"])())V();else if(u.value&&u.value.ownerDocument){var t=e.cloudChannel?e.cloudChannel:"5",n=e.apiKey?e.apiKey:"no-api-key",o=p(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+n+"/tinymce/"+t+"/tinymce.min.js":e.tinymceScriptSrc;O.load(u.value.ownerDocument,o,V)}})),Object(o["onBeforeUnmount"])((function(){null!==Object(v["a"])()&&Object(v["a"])().remove(b)})),j||(Object(o["onActivated"])((function(){k||V()})),Object(o["onDeactivated"])((function(){var e;g||(S=b.getContent()),null===(e=Object(v["a"])())||void 0===e||e.remove(b)})));var N=function(e){var t;S=b.getContent(),null===(t=Object(v["a"])())||void 0===t||t.remove(b),n=h(h({},n),e),Object(o["nextTick"])((function(){return V()}))};return t.expose({rerender:N}),function(){return j?y(o["h"],m,u,e.tagName):C(o["h"],m,u)}}});t["a"]=k},f05d:function(e,t,n){}}]);
//# sourceMappingURL=chunk-52e07ad6.8f8eebda.js.map